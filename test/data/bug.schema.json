{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "properties": {
    "devices": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "address": {
            "type": "integer"
          },
          "name": {
            "type": "string"
          },
          "type": {
            "type": "string",
            "enum": [
              "pcf8574",
              "pcf8575",
              "mcp23017"
            ]
          },
          "config": {
            "type": "object",
            "oneOf": [
              {
                "if": {
                  "properties": {
                    "type": {
                      "const": "mcp23017"
                    }
                  }
                },
                "then": {
                  "type": "object",
                  "properties": {
                    "reset": {
                      "type": "integer"
                    },
                    "patternProperties": {
                      "^[A-Z]+$": {
                        "type": "object",
                        "properties": {
                          "irq": {
                            "type": "integer"
                          },
                          "pins": {
                            "type": "string",
                            "pattern": "^[A-Z]+[0-9]+_[0-9]+$"
                          }
                        },
                        "required": [
                          "irq",
                          "pins"
                        ]
                      }
                    }
                  },
                  "required": [
                    "reset"
                  ]
                }
              },
              {
                "if": {
                  "properties": {
                    "type": {
                      "const": "pcf8575"
                    }
                  }
                },
                "then": {
                  "type": "object",
                  "properties": {
                    "pins": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "cid": {
                            "type": "string",
                            "pattern": "^[A-Z]+[0-9]+_[0-9]+$"
                          },
                          "pole": {
                            "type": "integer"
                          }
                        },
                        "required": [
                          "cid",
                          "pole"
                        ]
                      }
                    }
                  },
                  "required": [
                    "pins"
                  ]
                }
              },
              {
                "if": {
                  "properties": {
                    "type": {
                      "const": "pcf8574"
                    }
                  }
                },
                "then": {
                  "type": "object",
                  "properties": {
                    "pins": {
                      "type": "array",
                      "items": {
                        "type": "string",
                        "pattern": "^[A-Z]+[0-9]+_[0-9]+$"
                      }
                    }
                  },
                  "required": [
                    "pins"
                  ]
                }
              }
            ]
          }
        },
        "required": [
          "address",
          "name",
          "type",
          "config"
        ]
      }
    }
  },
  "required": [
    "devices"
  ]
}